{
  "name": "mobile",
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "apps/mobile/src",
  "projectType": "application",
  "tags": [],
  "targets": {
    "start": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "apps/mobile",
        "command": "expo start"
      }
    },
    "start:devclient": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "apps/mobile",
        "command": "expo start --dev-client"
      }
    },
    "android": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "apps/mobile",
        "command": "expo run:android"
      }
    },
    "ios": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "apps/mobile",
        "command": "expo run:ios"
      }
    },

    "build:web": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "apps/mobile",
        "command": "expo export --platform web --output-dir dist"
      }
    },
    "build:web:dev": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": ".",
        "command": "bash -lc 'set -euo pipefail; cd apps/mobile; EXPO_PUBLIC_API_BASE=${EXPO_PUBLIC_API_BASE:-http://127.0.0.1:9101} EXPO_NO_TELEMETRY=1 npx expo export --platform web --output-dir dist --clear'"
      }
    },
    "copy:web:to:assets": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": ".",
        "command": "bash -lc 'set -euo pipefail; REPO=$(git rev-parse --show-toplevel); SRC=apps/mobile/dist; DEST=$REPO/apps/client/edb/src/assets/clara; mkdir -p \"$DEST\"; rm -rf \"$DEST\"/* || true; cp -R \"$SRC\"/* \"$DEST\"/'"
      }
    },

    "dev": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": ".",
        "command": "pnpm nx run mobile:build:web:dev && pnpm nx run mobile:copy:web:to:assets"
      }
    },

    "staging": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": ".",
        "command": "apps/mobile/tools/mobile-staging.sh"
      }
    }
  }
}
