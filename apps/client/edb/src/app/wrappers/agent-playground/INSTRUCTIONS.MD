Agent Playground — Generators Quick Guide

Frontend rules (Agent)
• Only create files here: apps/client/edb/src/app/agent-playground/
(components + services only; no new libs, no global refactors, no routing changes outside this folder).
• Styling: Tailwind classes only (no inline styles).
• APIs: Call the endpoints generated by the backend generators below.

⸻

Generators (what exists today)

All commands assume the plugin name is @edb-workbench/plugin and you run them with pnpm nx g.

1. workbench-api-model
   • Purpose: Define a domain model (contract JSON + Zod schemas).
   • Usage:

pnpm nx g @edb-workbench/plugin:workbench-api-model --name=<plural>
--fields="name:string,amount?:number,status:enum(draft|active|archived),when?:date"

    •	Notes:
    •	--fields supports optional ?, enum(a|b|c), and date.
    •	--revert removes generated model artifacts.

2. workbench-api-resource
   • Purpose: Create Fastify controller/service/routes for CRUD.
   • Usage:

pnpm nx g @edb-workbench/plugin:workbench-api-resource --name=<plural>

    •	Notes:
    •	Exposes: GET /<plural>, GET /<plural>/:id, POST, PATCH, DELETE.
    •	--revert cleans up.

3. workbench-api-infra
   • Purpose: DB + repo layer (Drizzle schema, \*.repo.pg.ts, tests).
   • Usage:

pnpm nx g @edb-workbench/plugin:workbench-api-infra --name=<plural>

    •	Migrations:

pnpm nx run workbench-api-infra:migrations:generate
pnpm nx run workbench-api-infra:migrate

    •	Notes: --revert removes infra artifacts (best‑effort).

4. workbench-api-rel (belongsTo only)
   • Purpose: Add a belongsTo relation (child → parent).
   • Usage:

pnpm nx g @edb-workbench/plugin:workbench-api-rel \
 --belongsTo="<childPlural>:<parentPlural>" \
 --fk="<parentSingular>Id" \
 --include="<alias>" \
 --onDelete="cascade|restrict|nullify" \
 --select="id,name" # parent fields allowed in includes

    •	What it does: adds FK column in child schema, updates contracts/Zod, repo filters/sorts, controller include hook, and register wiring.
    •	Revert:

pnpm nx g @edb-workbench/plugin:workbench-api-rel \
 --belongsTo="<childPlural>:<parentPlural>" --fk="<parentSingular>Id" \
 --include="<alias>" --revert

⸻

Minimal workflow (example)

pnpm nx build workbench-plugin

# Define models

pnpm nx g @edb-workbench/plugin:workbench-api-model --name=projects --fields="name:string,status:enum(active|archived)"
pnpm nx g @edb-workbench/plugin:workbench-api-model --name=tasks --fields="title:string,due?:date"

# Expose CRUD

pnpm nx g @edb-workbench/plugin:workbench-api-resource --name=projects
pnpm nx g @edb-workbench/plugin:workbench-api-resource --name=tasks

# DB/Repo

pnpm nx g @edb-workbench/plugin:workbench-api-infra --name=projects
pnpm nx g @edb-workbench/plugin:workbench-api-infra --name=tasks

# Relation: tasks → projects (belongsTo)

pnpm nx g @edb-workbench/plugin:workbench-api-rel \
 --belongsTo="tasks:projects" --fk="projectId" --include="project" \
 --onDelete="cascade" --select="id,name"

# Apply DB changes

pnpm nx run workbench-api-infra:migrations:generate
pnpm nx run workbench-api-infra:migrate

Then (Agent): build UI only inside apps/client/edb/src/app/agent-playground/ using Angular components/services that call /projects and /tasks endpoints.
